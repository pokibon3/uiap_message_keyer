# UIAP Message Keyer (CH32V003) Ver1.1

OLED表示、メッセージ自動送信/録音、CWデコード表示を備えたCWキーヤー。
蚰蜒倶楽部さんが電波文化祭2025で配布されていた[UIAP KEYER](https://www.gejigeji.com/?page_id=1045)のファームウェアをベースに拡張したものです。  
OLED表示、メッセージ記録/送信、CWデコード機能を追加しています。

## 仕様
- パドル打鍵（DOT/DASH）、スピード速度可変（5〜40 WPM）。スピードはOLEDに表示します。
- 記録メッセージA/Bの自動送信（単発/リピート）。
- メッセージの記録（2スロット、各最大255バイト）。
- OLED表示（速度表示 + 送信文字のスクロール表示）。
- CWデコード表示（欧文/和文対応）。

## ハードウェア
- MCU: UIAPduino CH32V003F4U6
- OLED: SSD1306 I2C 128x64
- パドル入力 + SW-A/SW-Bスイッチ
- サイドトーン出力/KEY出力

## 操作方法
### 通常モード（起動直後）
- `SW-A`短押し: メッセージAを1回送信。
- `SW-B`短押し: メッセージBを1回送信。
- `SW-A`長押し（約1.5s）: メッセージAをリピート送信。
- `SW-B`長押し（約1.5s）: メッセージBをリピート送信。
- 自動送信中にパドル操作すると停止。

### メッセージ記録モード
- `SW-A + SW-B`同時長押し（約1.5s）で記録モードを開始、もう一度`SW-A + SW-B`長押しで通常モードに移行。

- 記録スロット選択:  
記録モード中にスイッチを押すことにより、記録を開始します。スイッチを押す前は練習モードです。
  - `SW-A`でメッセージA録音開始。
  - `SW-B`でメッセージB録音開始。
- 記録終了:
  - 同じスイッチを押すと確定保存。
  - もう一方のスイッチを押すとキャンセル。
- 記録訂正:   
　- 訂正符号(HH)入力で、記録中の直前の1文字を削除する。

　※ 記録モード開始後はパドル入力が可能ですが、記録スロットの選択スイッチを押した時点から記録が開始されます。誤入力した場合は、もう一方のスイッチを押すことによりキャンセルできます。  

## CWデコード機能
- パドル入力を解析し、文字コードに変換します（欧文/和文対応）。  
- 起動直後の学習初期値は20WPMです。
- 半角カタカナ（0xA1-0xDF）は和文として扱います。
- ホレ/ラタの制御は2バイトの組み合わせで判定します。

## 開発環境
- Visual Studio CodeとPlatformIO環境が必要です。  

## 履歴
Ver 1.0 2025/12/21 新規作成  
Ver 1.1 2025/12/26 メッセージ記録機能追加  
Ver 1.2 2025/12/29 記録メッセージ訂正琴桜追加
